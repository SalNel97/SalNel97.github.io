---
title: "NYC Restaurant Inspections"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
    source: embed
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
library(tidyverse)
library(p8105.datasets)
library(plotly)
library(flexdashboard)

library(htmlwidgets)
```

<!-- Setting up dataframe and filtering it out. -->

```{r, message=FALSE, warning=FALSE, echo=FALSE}
data("rest_inspec")

rest_inspec =
  rest_inspec %>% 
  select(inspection_date, boro, dba, cuisine_description, action, grade, score, critical_flag) %>% 
  filter(
    action == c("Violations were cited in the following area(s)", "No violations were recorded at the time of this inspection", "Establishment Closed by DOHMH.  Violations were cited in the following area(s) and those requiring immediate action were addressed.")) %>% 
      drop_na(score)
```


Column {data-width=650}
-----------------------------------------------------------------------

### Scatter plot of inspection score as a function of inspection date.

```{r, message=FALSE, warning=FALSE, echo=FALSE}
rest_inspec %>% 
  mutate(label = str_c("Score: ", score)) %>% 
  plot_ly(
    x = ~inspection_date, y = ~score, color = ~critical_flag, text = ~label, alpha = .5, type = "scatter", mode = "markers", colors = "viridis")
```

Column {data-width=350}
-----------------------------------------------------------------------

### A box plot showing the average inpection score per Borough

```{r, message=FALSE, warning=FALSE, echo=FALSE}
rest_inspec %>% 
  plot_ly(
    x = ~boro, y = ~score, color = ~boro, alpha = .5, type = "box", mode = "markers", colors = "viridis")
```

### A bar plot showing the number of inspections per restaurant cuisine type.

```{r, message=FALSE, warning=FALSE, echo=FALSE}
rest_inspec %>% 
  count(cuisine_description) %>% 
  mutate(cuisine_description = fct_reorder(cuisine_description, n)) %>% 
  plot_ly(
    x = ~cuisine_description, y = ~n, alpha = .5, type = "bar", mode = "markers", colors = "viridis")
```

